import{V as l,f as o,p as r,n as c}from"./index-89840f01.js";import{T as d}from"./index-bae49d81.js";import{C as u,a as h,b as p,c as _}from"./index-cce7da55.js";const T=l.extend({name:"ListBase",components:{SearchIcon:o,Trend:d},data(){return{CONTRACT_STATUS:u,CONTRACT_STATUS_OPTIONS:h,CONTRACT_TYPES:p,CONTRACT_PAYMENT_TYPES:_,prefix:r,dataLoading:!1,data:[],selectedRowKeys:[1,2],value:"first",columns:[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{title:"合同名称",align:"left",width:250,ellipsis:!0,colKey:"name",fixed:"left"},{title:"合同状态",colKey:"status",width:200,cell:{col:"status"}},{title:"合同编号",width:200,ellipsis:!0,colKey:"no"},{title:"合同类型",width:200,ellipsis:!0,colKey:"contractType"},{title:"合同收付类型",width:200,ellipsis:!0,colKey:"paymentType"},{title:"合同金额 (元)",width:200,ellipsis:!0,colKey:"amount"},{align:"left",fixed:"right",width:200,colKey:"op",title:"操作"}],rowKey:"index",tableLayout:"auto",verticalAlign:"top",hover:!0,rowClassName:e=>`${e}-class`,pagination:{defaultPageSize:20,total:0,defaultCurrent:1},searchValue:"",confirmVisible:!1,deleteIdx:-1}},computed:{confirmBody(){var e;if(this.deleteIdx>-1){const{name:s}=(e=this.data)==null?void 0:e[this.deleteIdx];return`删除后，${s}的所有合同信息将被清空，且无法恢复`}return""},offsetTop(){return this.$store.state.setting.isUseTabsRouter?48:0}},mounted(){this.dataLoading=!0,this.$request.get("/api/get-list").then(e=>{if(e.code===0){const{list:s=[]}=e.data;this.data=s,this.pagination={...this.pagination,total:s.length}}}).catch(e=>{console.log(e)}).finally(()=>{this.dataLoading=!1})},methods:{getContainer(){return document.querySelector(".tdesign-starter-layout")},rehandlePageChange(e,s){console.log("分页变化",e,s)},rehandleSelectChange(e){this.selectedRowKeys=e},rehandleChange(e,s){console.log("统一Change",e,s)},handleClickDetail(){this.$router.push("/detail/base")},handleSetupContract(){this.$router.push("/form/base")},handleClickDelete(e){this.deleteIdx=e.rowIndex,this.confirmVisible=!0},onConfirmDelete(){this.data.splice(this.deleteIdx,1),this.pagination.total=this.data.length;const e=this.selectedRowKeys.indexOf(this.deleteIdx);e>-1&&this.selectedRowKeys.splice(e,1),this.confirmVisible=!1,this.$message.success("删除成功"),this.resetIdx()},onCancel(){this.resetIdx()},resetIdx(){this.deleteIdx=-1}}});var f=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("t-card",{staticClass:"list-card-container",attrs:{bordered:!1}},[t("t-row",{attrs:{justify:"space-between"}},[t("div",{staticClass:"left-operation-container"},[t("t-button",{on:{click:e.handleSetupContract}},[e._v(" 新建合同 ")]),t("t-button",{attrs:{variant:"base",theme:"default",disabled:!e.selectedRowKeys.length}},[e._v(" 导出合同 ")]),e.selectedRowKeys.length?t("p",{staticClass:"selected-count"},[e._v("已选"+e._s(e.selectedRowKeys.length)+"项")]):e._e()],1),t("t-input",{staticClass:"search-input",attrs:{placeholder:"请输入你需要搜索的内容",clearable:""},scopedSlots:e._u([{key:"suffix-icon",fn:function(){return[t("search-icon",{attrs:{size:"20px"}})]},proxy:!0}]),model:{value:e.searchValue,callback:function(n){e.searchValue=n},expression:"searchValue"}})],1),t("div",{staticClass:"table-container"},[t("t-table",{attrs:{columns:e.columns,data:e.data,rowKey:e.rowKey,verticalAlign:e.verticalAlign,hover:e.hover,pagination:e.pagination,"selected-row-keys":e.selectedRowKeys,loading:e.dataLoading,headerAffixedTop:!0,headerAffixProps:{offsetTop:e.offsetTop,container:e.getContainer}},on:{"page-change":e.rehandlePageChange,change:e.rehandleChange,"select-change":e.rehandleSelectChange},scopedSlots:e._u([{key:"status",fn:function(n){var a=n.row;return[a.status===e.CONTRACT_STATUS.FAIL?t("t-tag",{attrs:{theme:"danger",variant:"light"}},[e._v("审核失败")]):e._e(),a.status===e.CONTRACT_STATUS.AUDIT_PENDING?t("t-tag",{attrs:{theme:"warning",variant:"light"}},[e._v("待审核")]):e._e(),a.status===e.CONTRACT_STATUS.EXEC_PENDING?t("t-tag",{attrs:{theme:"warning",variant:"light"}},[e._v("待履行")]):e._e(),a.status===e.CONTRACT_STATUS.EXECUTING?t("t-tag",{attrs:{theme:"success",variant:"light"}},[e._v("履行中")]):e._e(),a.status===e.CONTRACT_STATUS.FINISH?t("t-tag",{attrs:{theme:"success",variant:"light"}},[e._v("已完成")]):e._e()]}},{key:"contractType",fn:function(n){var a=n.row;return[a.contractType===e.CONTRACT_TYPES.MAIN?t("p",[e._v("审核失败")]):e._e(),a.contractType===e.CONTRACT_TYPES.SUB?t("p",[e._v("待审核")]):e._e(),a.contractType===e.CONTRACT_TYPES.SUPPLEMENT?t("p",[e._v("待履行")]):e._e()]}},{key:"paymentType",fn:function(n){var a=n.row;return[a.paymentType===e.CONTRACT_PAYMENT_TYPES.PAYMENT?t("p",{staticClass:"payment-col"},[e._v(" 付款 "),t("trend",{staticClass:"dashboard-item-trend",attrs:{type:"up"}})],1):e._e(),a.paymentType===e.CONTRACT_PAYMENT_TYPES.RECIPT?t("p",{staticClass:"payment-col"},[e._v(" 收款 "),t("trend",{staticClass:"dashboard-item-trend",attrs:{type:"down"}})],1):e._e()]}},{key:"op",fn:function(n){return[t("a",{staticClass:"t-button-link",on:{click:function(a){return e.handleClickDetail()}}},[e._v("详情")]),t("a",{staticClass:"t-button-link",on:{click:function(a){return e.handleClickDelete(n)}}},[e._v("删除")])]}}])})],1)],1),t("t-dialog",{attrs:{header:"确认删除当前所选合同？",body:e.confirmBody,visible:e.confirmVisible,onCancel:e.onCancel},on:{"update:visible":function(n){e.confirmVisible=n},confirm:e.onConfirmDelete}})],1)},C=[];const i={};var g=c(T,f,C,!1,y,"2e777b66",null,null);function y(e){for(let s in i)this[s]=i[s]}const w=function(){return g.exports}();export{w as default};
