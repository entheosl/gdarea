import{n as i,p as r}from"./index-89840f01.js";import{T as l}from"./index-bae49d81.js";import{C as c,a as m,b as d,d as u,c as f}from"./index-cce7da55.js";var p=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"list-common-table"},[e("t-form",{ref:"form",style:{marginBottom:"8px"},attrs:{data:t.formData,"label-width":80,colon:""},on:{reset:t.onReset,submit:t.onSubmit}},[e("t-row",[e("t-col",{attrs:{span:10}},[e("t-row",{attrs:{gutter:[16,24]}},[e("t-col",{attrs:{flex:1}},[e("t-form-item",{attrs:{label:"合同名称",name:"name"}},[e("t-input",{staticClass:"form-item-content",style:{minWidth:"134px"},attrs:{type:"search",placeholder:"请输入合同名称"},model:{value:t.formData.name,callback:function(a){t.$set(t.formData,"name",a)},expression:"formData.name"}})],1)],1),e("t-col",{attrs:{flex:1}},[e("t-form-item",{attrs:{label:"合同状态",name:"status"}},[e("t-select",{staticClass:"form-item-content`",attrs:{options:t.CONTRACT_STATUS_OPTIONS,placeholder:"请选择合同状态"},model:{value:t.formData.status,callback:function(a){t.$set(t.formData,"status",a)},expression:"formData.status"}})],1)],1),e("t-col",{attrs:{flex:1}},[e("t-form-item",{attrs:{label:"合同编号",name:"no"}},[e("t-input",{staticClass:"form-item-content",style:{minWidth:"134px"},attrs:{placeholder:"请输入合同编号"},model:{value:t.formData.no,callback:function(a){t.$set(t.formData,"no",a)},expression:"formData.no"}})],1)],1),e("t-col",{attrs:{flex:1}},[e("t-form-item",{attrs:{label:"合同类型",name:"type"}},[e("t-select",{staticClass:"form-item-content`",attrs:{options:t.CONTRACT_TYPE_OPTIONS,placeholder:"请选择合同类型"},model:{value:t.formData.type,callback:function(a){t.$set(t.formData,"type",a)},expression:"formData.type"}})],1)],1)],1)],1),e("t-col",{staticClass:"operation-container",attrs:{span:2}},[e("t-button",{style:{marginLeft:"8px"},attrs:{theme:"primary",type:"submit"}},[t._v(" 查询 ")]),e("t-button",{attrs:{type:"reset",variant:"base",theme:"default"}},[t._v(" 重置 ")])],1)],1)],1),e("div",{staticClass:"table-container"},[e("t-table",{attrs:{data:t.data,columns:t.columns,rowKey:t.rowKey,verticalAlign:t.verticalAlign,hover:t.hover,pagination:t.pagination,loading:t.dataLoading,headerAffixedTop:!0,headerAffixProps:{offsetTop:t.offsetTop,container:t.getContainer}},on:{"page-change":t.rehandlePageChange,change:t.rehandleChange},scopedSlots:t._u([{key:"status",fn:function(a){var s=a.row;return[s.status===t.CONTRACT_STATUS.FAIL?e("t-tag",{attrs:{theme:"danger",variant:"light"}},[t._v("审核失败")]):t._e(),s.status===t.CONTRACT_STATUS.AUDIT_PENDING?e("t-tag",{attrs:{theme:"warning",variant:"light"}},[t._v("待审核")]):t._e(),s.status===t.CONTRACT_STATUS.EXEC_PENDING?e("t-tag",{attrs:{theme:"warning",variant:"light"}},[t._v("待履行")]):t._e(),s.status===t.CONTRACT_STATUS.EXECUTING?e("t-tag",{attrs:{theme:"success",variant:"light"}},[t._v("履行中")]):t._e(),s.status===t.CONTRACT_STATUS.FINISH?e("t-tag",{attrs:{theme:"success",variant:"light"}},[t._v("已完成")]):t._e()]}},{key:"contractType",fn:function(a){var s=a.row;return[s.contractType===t.CONTRACT_TYPES.MAIN?e("p",[t._v("审核失败")]):t._e(),s.contractType===t.CONTRACT_TYPES.SUB?e("p",[t._v("待审核")]):t._e(),s.contractType===t.CONTRACT_TYPES.SUPPLEMENT?e("p",[t._v("待履行")]):t._e()]}},{key:"paymentType",fn:function(a){var s=a.row;return[s.paymentType===t.CONTRACT_PAYMENT_TYPES.PAYMENT?e("p",{staticClass:"payment-col"},[t._v(" 付款 "),e("trend",{staticClass:"dashboard-item-trend",attrs:{type:"up"}})],1):t._e(),s.paymentType===t.CONTRACT_PAYMENT_TYPES.RECIPT?e("p",{staticClass:"payment-col"},[t._v(" 收款 "),e("trend",{staticClass:"dashboard-item-trend",attrs:{type:"down"}})],1):t._e()]}},{key:"op",fn:function(a){return[e("a",{staticClass:"t-button-link",on:{click:function(s){return t.rehandleClickOp(a)}}},[t._v("管理")]),e("a",{staticClass:"t-button-link",on:{click:function(s){return t.handleClickDelete(a)}}},[t._v("删除")])]}}])}),e("t-dialog",{attrs:{header:"确认删除当前所选合同？",body:t.confirmBody,visible:t.confirmVisible,onCancel:t.onCancel},on:{"update:visible":function(a){t.confirmVisible=a},confirm:t.onConfirmDelete}})],1)],1)},T=[];const h={name:"list-table",components:{Trend:l},data(){return{CONTRACT_STATUS:c,CONTRACT_STATUS_OPTIONS:m,CONTRACT_TYPES:d,CONTRACT_TYPE_OPTIONS:u,CONTRACT_PAYMENT_TYPES:f,prefix:r,formData:{name:"",no:void 0,status:void 0},data:[],dataLoading:!1,value:"first",columns:[{title:"合同名称",fixed:"left",width:200,align:"left",ellipsis:!0,colKey:"name"},{title:"合同状态",colKey:"status",width:200,cell:{col:"status"}},{title:"合同编号",width:200,ellipsis:!0,colKey:"no"},{title:"合同类型",width:200,ellipsis:!0,colKey:"contractType"},{title:"合同收付类型",width:200,ellipsis:!0,colKey:"paymentType"},{title:"合同金额 (元)",width:200,ellipsis:!0,colKey:"amount"},{align:"left",fixed:"right",width:200,colKey:"op",title:"操作"}],rowKey:"index",tableLayout:"auto",verticalAlign:"top",bordered:!0,hover:!0,rowClassName:t=>`${t}-class`,pagination:{defaultPageSize:20,total:100,defaultCurrent:1},confirmVisible:!1,deleteIdx:-1}},computed:{confirmBody(){var t;if(this.deleteIdx>-1){const{name:n}=(t=this.data)==null?void 0:t[this.deleteIdx];return`删除后，${n}的所有合同信息将被清空，且无法恢复`}return""},offsetTop(){return this.$store.state.setting.isUseTabsRouter?48:0}},mounted(){this.dataLoading=!0,this.$request.get("/api/get-list").then(t=>{if(t.code===0){const{list:n=[]}=t.data;this.data=n,this.pagination={...this.pagination,total:n.length}}}).catch(t=>{console.log(t)}).finally(()=>{this.dataLoading=!1})},methods:{getContainer(){return document.querySelector(".tdesign-starter-layout")},onReset(t){console.log(t)},onSubmit(t){console.log(t)},rehandlePageChange(t,n){console.log("分页变化",t,n)},rehandleChange(t,n){console.log("统一Change",t,n)},rehandleClickOp({text:t,row:n}){console.log(t,n)},handleClickDelete(t){this.deleteIdx=t.rowIndex,this.confirmVisible=!0},onConfirmDelete(){this.data.splice(this.deleteIdx,1),this.pagination.total=this.data.length,this.confirmVisible=!1,this.$message.success("删除成功"),this.resetIdx()},onCancel(){this.resetIdx()},resetIdx(){this.deleteIdx=-1}}},o={};var _=i(h,p,T,!1,C,"3e3459b0",null,null);function C(t){for(let n in o)this[n]=o[n]}const b=function(){return _.exports}();export{b as C};
